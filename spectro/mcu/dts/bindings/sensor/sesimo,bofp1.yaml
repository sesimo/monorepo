
include: [base.yaml, spi-device.yaml]

compatible: sesimo,bofp1
description: Device driver for the SESIMO FPGA CCD Sensor bridge (BOFP1)

properties:
  prescaler:
    type: int
    default: 0
    description: |
      Prescaler for the timing parameters used on the FPGA. Timing parameters
      are calculated as `CLK/((PSC + 1) * DIV)`

  clock-frequency:
    type: int
    default: 100000000
    description: |
      Operating clock frequency (in Hz) for the FPGA. 

  clkdiv:
    type: int
    default: 0
    description: |
      Clock divider value. The master clock frequency for the CCD is given
      by `f = clock-frequency / (25 + 100/7 * clkdiv)`

  integration-time:
    type: int
    default: 20000
    description: |
      Set integration time (in nanoseconds). The integration time is determined
      by the periodicity of the SH signal on the FPGA. The frequency of this
      signal is given by `f = MCLK/((PSC+1) * SH)`, that is, it is
      dependent on both the MCLK frequency and the PSC value. The integration
      time attribute only adjusts the SH value, so MCLK and PSC may need
      to be manually adjusted to obtain the best possible frequnecy.


  busy-gpios:
    description: |
      GPIO for indicating if the CCD is busy
    type: phandle-array
    required: true

  fifo-wmark-gpios:
    description: |
      FIFO watermark GPIO (more than 256 elements in the FIFO)
    type: phandle-array
    required: true
